<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>VOIP Example - Max Stanley's Blog</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=author content><meta name=keywords content><link rel=canonical href=https://maxstanley.uk/page/packet_tracer/voip_example/><link rel=stylesheet type=text/css href=https://maxstanley.uk//css/fuckjs.css><link rel=stylesheet type=text/css href=https://maxstanley.uk//css/github-markdown.css></head><body class=markdown-body><header><nav><h1><a href=https://maxstanley.uk/>Max Stanley's Blog</a></h1><ul><li><a href=https://maxstanley.uk/tags/>Tags</a></li><li><a href=https://maxstanley.uk/about/>About</a></li><li><a href=https://maxstanley.uk/contact/>Contact</a></li></ul></nav></header><section><h1>VOIP Example</h1><article><h2 id=layout>Layout</h2><p>3 IP Phones connected to a 2960 Switch, with a 2811 Router connected to the switch. Each IP Phone has a PC on its PC Port.</p><h2 id=configuring-the-switch>Configuring the Switch</h2><h3 id=creating-vlans>Creating VLANs</h3><pre><code class=language-ios data-lang=ios>Switch&gt;enable
Switch#configure terminal
Switch(config)#vlan 20
Switch(config-vlan)#name PC
Switch(config-vlan)#vlan 30
Switch(config-vlan)#name VOICE
</code></pre><h3 id=configuring-ports>Configuring Ports</h3><pre><code class=language-ios data-lang=ios>Switch&gt;enable
Switch#configure terminal
Switch(config)#interface fa0/24
Switch(config-if)#switchport mode trunk
Switch(config-if)#interface range fa0/1-3
Switch(config-if-range)#switchport mode access
Switch(config-if-range)#switchport access vlan 20
Switch(config-if-range)#switchport voice vlan 30
Switch(config-if-range)#interface range fa0/4-23
Switch(config-if-range)#switchport mode access
Switch(config-if-range)#shutdown
Switch(config-if-range)#interface range gig0/1-2
Switch(config-if-range)#switchport mode access
Switch(config-if-range)#shutdown
</code></pre><h3 id=save-configuration>Save Configuration</h3><pre><code class=language-ios data-lang=ios>Switch&gt;enable
Switch#copy running-config startup-config
</code></pre><h2 id=configuring-the-router>Configuring the Router</h2><h3 id=configuring-vlans>Configuring VLANs</h3><pre><code class=language-ios data-lang=ios>Router&gt;enable
Router#configure terminal
Router(config)#interface fa0/0.20
Router(config-subif)#encapsulation dot1Q 20
Router(config-subif)#ip address 192.168.20.1 255.255.255.0
Router(config-subif)#interface fa0/0.30
Router(config-subif)#encapsulation dot1Q 30
Router(config-subif)#ip address 192.168.30.1 255.255.255.0
Router(config-subif)#interface fa0/0
Router(config-if)#no shutdown
</code></pre><h3 id=configuring-dhcp>Configuring DHCP</h3><pre><code class=language-ios data-lang=ios>Router&gt;enable
Router#configure terminal
Router(config)#ip dhcp excluded-address 192.168.20.1 192.168.20.99
Router(config)#ip dhcp excluded-address 192.168.30.1 192.168.30.99
Router(config)#ip dhcp pool PC20
Router(dhcp-config)#network 192.168.20.0 255.255.255.0
Router(dhcp-config)#default-router 192.168.20.1
Router(dhcp-config)#ip dhcp pool VOICE30
Router(dhcp-config)#network 192.168.30.0 255.255.255.0
Router(dhcp-config)#default-router 192.168.30.1
</code></pre><h3 id=configure-voip>Configure VOIP</h3><pre><code class=language-ios data-lang=ios>Router&gt;enable
Router#configure terminal
Router(config)#ip dhcp pool VOICE30
Router(dhcp-config)#option 150 ip 192.168.30.1
Router(dhcp-config)#exit
Router(config)#telephony-service
Router(config=telephony)#max-dn 3
Router(config=telephony)#max-ephones 3
Router(config=telephony)#ip source-address 192.168.30.1 port 2000
Router(config=telephony)#exit
Router(config)#ephone-dn 1
Router(config-ephone-dn)#number 1010
Router(config-ephone-dn)#ephone-dn 2
Router(config-ephone-dn)#number 1020
Router(config-ephone-dn)#ephone-dn 3
Router(config-ephone-dn)#number 1030
Router(config-ephone-dn)#exit
Router(config)#ephone 1
Router(config-ephone)#type 7960
Router(config-ephone)#button 1:1
Router(config-ephone)#ephone 2
Router(config-ephone)#type 7960
Router(config-ephone)#button 1:2
Router(config-ephone)#ephone 3
Router(config-ephone)#type 7960
Router(config-ephone)#button 1:3
Router(config-ephone)#exit
Router(config)#exit
Router#copy running-config startup-config
</code></pre><h2 id=result>Result</h2><p>Now the IP Phones can be plugged in, they will recieve a DHPC lease and will be registered with the VOIP Service.
The Phones can be dialed to each other from the GUI by dialing the number and clicking on the handset.</p><p>The PCs should also be able to ping each other, ensure that they are set to DHCP so they can also get a lease on their VLAN.</p></article></section><footer><small>Copyright &#169; 2021<br>Powered by <a href=http://gohugo.io/ target=_blank>Hugo</a> & <a href=https://github.com/maxstanley/hugo-theme-fuck-js target=_blank>fuck-js</a></small></footer></body></html>